{"ast":null,"code":"// src/router/index.js\nimport { createRouter, createWebHistory } from 'vue-router';\nimport Login from '../views/Login.vue';\nimport Signup from '../views/Signup.vue';\nimport Admin from '../views/Admin.vue';\nimport Editor from '../views/Editor.vue';\nimport UserHome from '../views/UserHome.vue';\nimport NotFound from '../views/NotFound.vue'; // 404 sayfası için (opsiyonel)\n\n// Basit JWT token süresi kontrolü için yardımcı fonksiyon\nfunction isTokenValid(token) {\n  if (!token) return false;\n  try {\n    const payload = JSON.parse(atob(token.split('.')[1]));\n    const exp = payload.exp;\n    if (!exp) return false;\n    // exp timestamp saniye cinsinden, Date.now() milisaniye\n    return exp * 1000 > Date.now();\n  } catch {\n    return false;\n  }\n}\nconst routes = [{\n  path: '/',\n  name: 'Login',\n  component: Login\n}, {\n  path: '/signup',\n  name: 'Signup',\n  component: Signup\n}, {\n  path: '/user',\n  name: 'UserHome',\n  component: UserHome,\n  meta: {\n    requiresAuth: true,\n    role: ['user']\n  }\n}, {\n  path: '/editor',\n  name: 'Editor',\n  component: Editor,\n  meta: {\n    requiresAuth: true,\n    role: ['editor']\n  }\n}, {\n  path: '/admin',\n  name: 'Admin',\n  component: Admin,\n  meta: {\n    requiresAuth: true,\n    role: ['admin']\n  }\n}, {\n  path: '/:pathMatch(.*)*',\n  name: 'NotFound',\n  component: NotFound\n}];\nconst router = createRouter({\n  history: createWebHistory(),\n  routes\n});\nrouter.beforeEach((to, from, next) => {\n  const token = localStorage.getItem('token');\n  const role = localStorage.getItem('role');\n  if (to.meta.requiresAuth) {\n    if (!token || !isTokenValid(token)) {\n      // Token yok veya geçersizse login sayfasına redirect, orijinal hedefi query ile gönder\n      return next({\n        path: '/',\n        query: {\n          redirect: to.fullPath\n        }\n      });\n    }\n    if (to.meta.role && !to.meta.role.includes(role)) {\n      alert('Bu sayfaya erişim izniniz yok.');\n      return next('/');\n    }\n  }\n  next();\n});\nexport default router;","map":{"version":3,"names":["createRouter","createWebHistory","Login","Signup","Admin","Editor","UserHome","NotFound","isTokenValid","token","payload","JSON","parse","atob","split","exp","Date","now","routes","path","name","component","meta","requiresAuth","role","router","history","beforeEach","to","from","next","localStorage","getItem","query","redirect","fullPath","includes","alert"],"sources":["C:/Users/Zeynep Esila/OneDrive/Desktop/Blog/blog-frontend/src/router/index.js"],"sourcesContent":["// src/router/index.js\r\nimport { createRouter, createWebHistory } from 'vue-router'\r\n\r\nimport Login from '../views/Login.vue'\r\nimport Signup from '../views/Signup.vue'\r\nimport Admin from '../views/Admin.vue'\r\nimport Editor from '../views/Editor.vue'\r\nimport UserHome from '../views/UserHome.vue'\r\nimport NotFound from '../views/NotFound.vue'  // 404 sayfası için (opsiyonel)\r\n\r\n// Basit JWT token süresi kontrolü için yardımcı fonksiyon\r\nfunction isTokenValid(token) {\r\n  if (!token) return false\r\n  try {\r\n    const payload = JSON.parse(atob(token.split('.')[1]))\r\n    const exp = payload.exp\r\n    if (!exp) return false\r\n    // exp timestamp saniye cinsinden, Date.now() milisaniye\r\n    return exp * 1000 > Date.now()\r\n  } catch {\r\n    return false\r\n  }\r\n}\r\n\r\nconst routes = [\r\n  {\r\n    path: '/',\r\n    name: 'Login',\r\n    component: Login\r\n  },\r\n  {\r\n    path: '/signup',\r\n    name: 'Signup',\r\n    component: Signup\r\n  },\r\n  {\r\n    path: '/user',\r\n    name: 'UserHome',\r\n    component: UserHome,\r\n    meta: { requiresAuth: true, role: ['user'] }\r\n  },\r\n  {\r\n    path: '/editor',\r\n    name: 'Editor',\r\n    component: Editor,\r\n    meta: { requiresAuth: true, role: ['editor'] }\r\n  },\r\n  {\r\n    path: '/admin',\r\n    name: 'Admin',\r\n    component: Admin,\r\n    meta: { requiresAuth: true, role: ['admin'] }\r\n  },\r\n  {\r\n    path: '/:pathMatch(.*)*',\r\n    name: 'NotFound',\r\n    component: NotFound\r\n  }\r\n]\r\n\r\nconst router = createRouter({\r\n  history: createWebHistory(),\r\n  routes\r\n})\r\n\r\nrouter.beforeEach((to, from, next) => {\r\n  const token = localStorage.getItem('token')\r\n  const role = localStorage.getItem('role')\r\n\r\n  if (to.meta.requiresAuth) {\r\n    if (!token || !isTokenValid(token)) {\r\n      // Token yok veya geçersizse login sayfasına redirect, orijinal hedefi query ile gönder\r\n      return next({ path: '/', query: { redirect: to.fullPath } })\r\n    }\r\n\r\n    if (to.meta.role && !to.meta.role.includes(role)) {\r\n      alert('Bu sayfaya erişim izniniz yok.')\r\n      return next('/')\r\n    }\r\n  }\r\n\r\n  next()\r\n})\r\n\r\nexport default router\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}